var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(g){return g.raw=g};$jscomp.createTemplateTagFirstArgWithRaw=function(g,a){g.raw=a;return g};
(function(g,a){"uses strict";"function"===typeof define&&define.amd?define([],build):"object"===typeof module&&module.exports?module.exports=a():g.Quiway=a()})(this,function(){void 0===[].findIndex&&(Array.prototype.findIndex=function(a){for(var b=0;b<this.length&&(out=a(this[b],b,this),!0!==out);b++);return i});var g=function(a){var b=this;this.shortcutslist=[];this.combo=[];this.duplicates=void 0===a?!1:a;this.KEYS="ctrl shift alt altGraph capslock tab backspace enter meta space escape pageup pagedown home insert delete end arrowup arrowdown arrowleft arrowright 1 2 3 4 5 6 7 8 9 0 a b c d e f g h i j k l m n o p q r s t u v w x y z * f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 f11".split(" ");
this.comboActivated=this.shortcutActivated=!0;this.intercativeMode=!1;this.toBuild=[[],[]];window.onkeydown=function(e){b.buildShortcut.call(b,e)};window.onkeyup=function(e){b.shortCutCancel.call(b,e)}};g.prototype={replace:function(a,b){var e=this.shortcutslist.find(function(c){return c[2].toString()===a.toString()});return void 0!==e?(this.unbind(e[0].join("+"),e[2]),this.bind(b,a),!0):!1},getFromUser:function(a,b,e,c){this.intercativeMode=!0;this.toBuild[1].push(a,b,void 0===e?500:e,c)},stopGettingFromUser:function(){this.intercativeMode=
!1;this.toBuild=[[],[]]},buildInteractivelly:function(a){},bind:function(a,b,e){a=void 0===a?"ctrl+q":a;b=void 0===b?function(){console.log("shortcut launch succefully!")}:b;e=void 0===e?500:e;if("string"!==typeof a)throw Error("Quiway TypeError:\nthe shortcut schema must be of type string : you passed a "+typeof a);if("function"!==typeof b)throw Error("Quiway TypeError:\nbind function require a callback as the secondparameter : you passed a "+typeof b);if("number"!==typeof e)throw Error("Quiway TypeError: \ntiming must be a millisecond presentation(number in thousands) :you passed a "+
typeof e);if(-1!==a.indexOf("+")&&-1!==a.indexOf(","))throw Error("Quiway SchemaError:\nthis shortcut =>'"+a+"' have wrong schema/syntax");if(-1!==a.indexOf("+")){a=a.split("+");e=Array(a.length);e.fill(!1,0,e.length);for(i=0;i<a.length;i++)if("control"===a[i]&&(a[i]="ctrl"),a[i]=a[i].toLowerCase(),-1===this.KEYS.indexOf(a[i]))throw Error("Quiway unknownKeyName:\nthe shortcut contains unknown key name "+a[i]);var c=this.check(a.join("+"));-1===c?this.shortcutslist.push([a,e,b]):this.duplicates?this.shortcutslist.push([a,
e,b]):this.shortcutslist[c]=[a,e,b]}else if(-1!==a.indexOf(",")){var d=a.split(",");keysmap=[];for(c=0;c<d.length;c++){d[c]=d[c].toLowerCase();if(-1===this.KEYS.indexOf(d[c]))throw Error("Quiway unknownKeyName: \n the shortcut contains unknown key name => "+a[c]);"control"===d[c]&&(d[c]="ctrl");if(-1!==d[c].indexOf("*")){d[c]=d[c].split("*");times=d[c][1];name=d[c][0];for(var f=0;f<times;f++)keysmap.push(name)}else keysmap.push(d[c])}d=d.join(",");c=this.check(d);-1===c?this.combo.push([keysmap,keysmap[0],
b,d,0,e]):this.duplicates?this.combo.push([keysmap,keysmap[0],b,d,0,e]):this.combo[c]=[keysmap,keysmap[0],b,d,0,e]}else a="control"===a.toLowerCase()?"ctrl":a.toLowerCase(),-1!==this.KEYS.indexOf(a)&&(c=this.check(a),-1===c?this.shortcutslist.push([[a],[!1],b]):this.duplicates?this.shortcutslist.push([[a],[!1],b]):this.shortcutslist[c]=[[a],[!1],b])},shortCutCancel:function(a){var b=a.key.toLowerCase();b="control"===b?"ctrl":b;b=" "===b?"space":b;if(!1===this.intercativeMode){var e;if(0!==this.shortcutslist.length){if(!1===
this.shortcutActivated)return;this.shortcutslist.forEach(function(d){!0===d[1][d[1].length-1]&&(a.preventDefault(),d[2](a));if(-1!==d[0].indexOf(b)){a.preventDefault();for(var f=d[0].indexOf(b);f<d[1].length;f++)d[1][f]=!1}})}!1!==this.comboActivated&&0!==this.combo.length&&this.combo.forEach(function(d,f){-1!==d[0].indexOf(b)&&(a.preventDefault(),d[1]===b||"*"===b)&&(void 0!=e&&clearTimeout(e),d[4]++,void 0!==d[0][d[4]]?d[1]=d[0][d[4]]:(d[2](a),d[4]=0,d[1]=d[0][0]),e=setTimeout(function(){d[4]=0;
d[1]=d[0][0]},d[5]))})}else{b="control"===b?"ctrl":b;var c=this.toBuild[0].findIndex(function(d){return d===b});-1!==c&&(this.toBuild[0].splice(c),this.toBuild[1][3](this.toBuild[0]))}},buildShortcut:function(a){var b=a.key.toLowerCase();b="control"===b?"ctrl":b;b=" "===b?"space":b;if(!1===this.intercativeMode)0!==this.shortcutslist.length&&!0===this.shortcutActivated&&this.shortcutslist.forEach(function(c){"*"===c[0][0]?(a.preventDefault(),c[1][0]=!0):-1!==c[1].indexOf(!0)&&"*"==c[0][c[1].lastIndexOf(!0)+
1]&&(a.preventDefault(),c[1][c[1].lastIndexOf(!0)+1]=!0);-1!==c[0].indexOf(b)&&(a.preventDefault(),!0===c[1][c[0].indexOf(b)-1]||void 0===c[1][c[0].indexOf(b)-1])&&(c[1][c[0].indexOf(b)]=!0)});else if(!0===this.intercativeMode&&(b="control"===b?"ctrl":b,-1===this.toBuild[0].findIndex(function(c){return c===b})&&(this.toBuild[0].push(b),this.toBuild[1][3](this.toBuild[0]),this.toBuild[0].length===this.toBuild[1][0]))){this.intercativeMode=!1;var e=this.toBuild[0].join("+");this.bind(e,this.toBuild[1][1],
this.toBuild[1][2]);this.toBuild[1][3](this.toBuild[0],!0);this.toBuild=[[],[]]}},unbind:function(a,b){var e=!1;if(-1!==a.indexOf("+")){if("all"==a)return this.shortcutslist=[],!0;a=a.split("+");a.forEach(function(d,f){"control"==d&&(a[f]="ctrl");a[f]=a[f].toLowerCase()});for(var c=0;c<this.shortcutslist.length;c++)if(this.shortcutslist[c][0].join("+")===a.join("+")&&this.shortcutslist[c][2].toString()===b.toString()){this.shortcutslist.splice(c,1);e=!0;break}return e}if(-1!==a.indexOf(",")){if("all"===
a)return this.combo=[],!0;for(c=0;c<this.combo.length;c++)if(combo[c][3]===a&&combo[c][2].toString()===b.toString()){this.combo.splice(c,1);e=!0;break}return e}},check:function(a){return-1!==a.indexOf("+")?this.shortcutslist.findIndex(function(b){return b[0].join("+")===a}):-1!==a.indexOf(",")?this.combo.findIndex(function(b){return b[3]===a}):this.shortcutslist.findIndex(function(b){return b[0]===a})}};return g});
